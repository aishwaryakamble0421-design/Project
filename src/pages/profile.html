<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profile — StepAhead</title>

<!-- Same Google Font as your main page -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<!-- Main Stylesheet -->
<link rel="stylesheet" href="/css/profile.css">

</head>
<body>

<!-- HEADER -->
<header class="site-header">
    <div class="container header-row">
        <div class="brand">StepAhead</div>
        <nav class="main-nav" aria-label="Primary">
            <ul>
                <li><a href="index.html#home">Home</a></li>
                <li><a href="index.html#aboutus">About Us</a></li>
                <li><a href="index.html#features">Features</a></li>
                <li><a href="index.html#who">Who We Help</a></li>
                <li><a href="profile.html" class="active">Profile</a></li>
            </ul>
        </nav>
        <a class="auth-btn" href="signup.html">Logout</a>
    </div>
</header>

<!-- PROFILE SECTION -->
<section class="profile-section">
    <div class="container">

        <div class="profile-card">
            
            <div class="profile-header">
                <div class="avatar" id="avatar">SA</div>
                <div>
                    <h2 id="name">User Name</h2>
                    <p id="email" class="muted">email@example.com</p>
                    <p id="joined" class="muted small">Member since —</p>
                </div>
            </div>

            <hr>

            <div class="profile-info">
                <h3>About</h3>
                <p id="bio">No bio added. Update soon!</p>
            </div>

            <div class="profile-links">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="selfassesment.html">Self Assessment</a></li>
                    <li><a href="pathmapping.html">Your Path Mapping</a></li>
                    <li><a href="nextlense.html">NextLens Insights</a></li>
                </ul>
            </div>

            <button id="logoutBtn" class="logout-btn">Logout</button>

        </div>

    </div>
</section>

<script>
const token = localStorage.getItem('token');

// Redirect if not logged in
if(!token){
    window.location.href = "signup.html";
}

// Fetch profile
fetch("/api/profile",{
    headers:{
        "Authorization": "Bearer " + token
    }
})
.then(async res => {
    if(!res.ok) throw new Error("Unauthorized");
    return res.json();
})
.then(data => {
    const user = data.user || data;

    document.getElementById("name").textContent = user.name || "User";
    document.getElementById("email").textContent = user.email || "—";
    document.getElementById("bio").textContent = user.bio || "No bio added yet.";

    if(user.createdAt){
        const d = new Date(user.createdAt);
        document.getElementById("joined").textContent = "Member since " + d.toLocaleDateString();
    }

    const initials = (user.name || "U")
        .split(" ")
        .map(w => w[0])
        .join("")
        .toUpperCase();

    document.getElementById("avatar").textContent = initials;

})
.catch(err => {
    alert("Session expired. Please login again.");
    localStorage.removeItem("token");
    window.location.href = "signup.html";
});

// Logout
document.getElementById("logoutBtn").addEventListener("click", () => {
    localStorage.removeItem("token");
    window.location.href = "signup.html";
});
</script>

</body>
</html>
